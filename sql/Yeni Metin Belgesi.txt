-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE public.active_powers
(
    id bigint NOT NULL,
    p1 double precision,
    p2 double precision,
    p3 double precision,
    psum double precision,
    created_at timestamp(0) without time zone NOT NULL,
    analizor_id smallint,
    PRIMARY KEY (id)
);

CREATE TABLE public.analizor_types
(
    id smallint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 32767 CACHE 1 ),
    type_name character varying(20) NOT NULL,
    created_at timestamp(0) without time zone,
    PRIMARY KEY (id)
);

CREATE TABLE public.analizors
(
    id smallint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 32767 CACHE 1 ),
    analizor_name character varying(50) NOT NULL,
    analizor_ip character varying(15) NOT NULL,
    analizor_port character varying(4) NOT NULL,
    gateway character varying(15) NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.another_things
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    "frequency-freq" double precision,
    "neutral_current-in" double precision,
    "voltage_unbalance-vunlb" double precision,
    "current_unbalance-iunlb" double precision,
    load_type double precision,
    analizor_id smallint,
    created_at timestamp(0) without time zone NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.apperent_powers
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    s1 double precision,
    s2 double precision,
    s3 double precision,
    ssum double precision,
    created_at timestamp(0) without time zone NOT NULL,
    analizor_id smallint,
    PRIMARY KEY (id)
);

CREATE TABLE public.currents
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    i1 double precision,
    i2 double precision,
    i3 double precision,
    i_avg double precision,
    analizor_id smallint,
    created_at time(0) without time zone NOT NULL,
    i_n double precision,
    PRIMARY KEY (id)
);

CREATE TABLE public.customers
(
    user_id integer NOT NULL,
    first_name character varying(25) NOT NULL,
    last_name character varying(25) NOT NULL,
    company_name character varying(100) NOT NULL,
    PRIMARY KEY (user_id)
);

CREATE TABLE public.data
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    p1 double precision,
    p2 double precision,
    p3 double precision,
    psum double precision,
    s1 double precision,
    s2 double precision,
    s3 double precision,
    ssum double precision,
    i1 double precision,
    i2 double precision,
    i3 double precision,
    i_average double precision,
    i1_dm double precision,
    i2_dm double precision,
    i3_dm double precision,
    iavg_dm double precision,
    q1 double precision,
    q2 double precision,
    q3 double precision,
    qsum double precision,
    ull12 double precision,
    ull23 double precision,
    ull13 double precision,
    ull_average double precision,
    uln1 double precision,
    uln2 double precision,
    uln3 double precision,
    uln_average double precision,
    pf1 double precision,
    pf2 double precision,
    pf3 double precision,
    pf_average double precision,
    voltage_unbalance double precision,
    current_unbalance double precision,
    analizor_id smallint NOT NULL,
    created_at timestamp(0) without time zone NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.energies
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    ae_imp double precision,
    ae_exp double precision,
    ae_total double precision,
    ae_net double precision,
    re_imp double precision,
    re_exp double precision,
    re_total double precision,
    re_net double precision,
    se_total double precision,
    created_at timestamp(0) without time zone NOT NULL,
    analizor_id smallint,
    PRIMARY KEY (id)
);

CREATE TABLE public.line_voltages
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    u12 double precision,
    u23 double precision,
    u13 double precision,
    ull_avg double precision,
    analizor_id smallint NOT NULL,
    created_at timestamp(0) without time zone NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.phase_voltages
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    u1 double precision,
    u2 double precision,
    u3 double precision,
    uln_avg double precision,
    analizor_id smallint,
    created_at timestamp(0) without time zone NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.power_factors
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    pf1 double precision,
    pf2 double precision,
    pf3 double precision,
    pf_average double precision,
    created_at timestamp(0) without time zone NOT NULL,
    analizor_id smallint NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.reactive_powers
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    q1 double precision,
    q2 double precision,
    q3 double precision,
    qsum double precision,
    analizor_id smallint,
    created_at timestamp(0) without time zone,
    PRIMARY KEY (id)
);

CREATE TABLE public.total_demands
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    p_dm double precision,
    q_dm double precision,
    s_dm double precision,
    i1_dm double precision,
    i2_dm double precision,
    i3_dm double precision,
    iavg_dm double precision,
    created_at timestamp(0) without time zone NOT NULL,
    analizor_id smallint,
    PRIMARY KEY (id)
);

CREATE TABLE public.unbalances
(
    id bigint NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    voltage_unbalance double precision,
    current_unbalance double precision,
    analizor_id smallint NOT NULL,
    created_at timestamp(0) without time zone NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.users
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483467 CACHE 1 ),
    email character varying(50) NOT NULL,
    password character varying(16) NOT NULL,
    phone_number character varying(16) NOT NULL,
    is_active boolean NOT NULL,
    created_at timestamp(0) without time zone NOT NULL,
    PRIMARY KEY (id)
);

ALTER TABLE public.active_powers
    ADD FOREIGN KEY (analizor_id)
    REFERENCES public.analizors (id)
    NOT VALID;


ALTER TABLE public.another_things
    ADD FOREIGN KEY (analizor_id)
    REFERENCES public.analizors (id)
    NOT VALID;


ALTER TABLE public.apperent_powers
    ADD FOREIGN KEY (analizor_id)
    REFERENCES public.analizors (id)
    NOT VALID;


ALTER TABLE public.currents
    ADD FOREIGN KEY (analizor_id)
    REFERENCES public.analizors (id)
    NOT VALID;


ALTER TABLE public.customers
    ADD FOREIGN KEY (user_id)
    REFERENCES public.users (id)
    NOT VALID;


ALTER TABLE public.data
    ADD FOREIGN KEY (analizor_id)
    REFERENCES public.analizors (id)
    NOT VALID;


ALTER TABLE public.energies
    ADD FOREIGN KEY (analizor_id)
    REFERENCES public.analizors (id)
    NOT VALID;


ALTER TABLE public.line_voltages
    ADD FOREIGN KEY (analizor_id)
    REFERENCES public.analizors (id)
    NOT VALID;


ALTER TABLE public.phase_voltages
    ADD FOREIGN KEY (analizor_id)
    REFERENCES public.analizors (id)
    NOT VALID;


ALTER TABLE public.power_factors
    ADD FOREIGN KEY (analizor_id)
    REFERENCES public.analizors (id)
    NOT VALID;


ALTER TABLE public.reactive_powers
    ADD FOREIGN KEY (analizor_id)
    REFERENCES public.analizors (id)
    NOT VALID;


ALTER TABLE public.total_demands
    ADD FOREIGN KEY (analizor_id)
    REFERENCES public.analizors (id)
    NOT VALID;

END;